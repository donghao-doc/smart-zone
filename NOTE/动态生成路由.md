# 动态生成路由（基于菜单）

## 目标
- 根据用户获取到的菜单列表动态生成路由
- 路由组件从 `src/router/router-map.tsx` 统一映射获取
- 菜单加载完成后将动态路由补充到路由表中

## 相关改动

### 1) 动态路由生成与注入
文件：`src/router/dynamic-routes.ts`
- `createMenuRoutes(menuList)`：递归遍历菜单列表，生成 `RouteObject[]`
- 使用 `componentMap` 将菜单路径映射到对应组件
- 使用 `registeredPaths` 去重，避免重复添加
- `addMenuRoutes(router, menuList, parentRouteId)`：调用 `router.patchRoutes` 将路由追加到指定父路由下

### 2) 路由表接入
文件：`src/router/index.tsx`
- 根路由增加 `ROOT_ROUTE_ID`，用于作为动态路由的挂载点
- 导出 `addMenuRoutes(menuList)`，内部调用动态路由注入方法

### 3) 菜单拉取后触发动态路由
文件：`src/components/page-layout/menu-nav/MenuNav.tsx`
- 菜单接口成功后：
  - `dispatch(setMenuList(res.data))`
  - 调用 `addMenuRoutes(res.data)` 动态补充路由

### 4) 菜单点击跳转
文件：`src/components/page-layout/menu-nav/MenuNav.tsx`
- `onClick` 使用 `navigate(key)` 跳转到对应路由

### 5) 组件映射
文件：`src/router/router-map.tsx`
- `componentMap` 维护菜单路径与页面组件的映射（`key` -> `element`）

## 流程说明
1. 登录后获取菜单列表
2. 将菜单列表写入 store
3. 通过 `addMenuRoutes` 将菜单路由注入到根路由下
4. 菜单点击时按 `key` 跳转到对应页面

## 注意事项
- 菜单路径必须与 `componentMap` 中的 key 一致，否则不会生成对应路由
- 动态路由仅在菜单加载成功后补充
